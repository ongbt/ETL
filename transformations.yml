- copy_columns:
    mapping:
      Name: Name_new
      Age: Age_new
      Email: Email_new
      Phone: Phone_new
      City: City_new
      Address: Address_new
      ZipCode: ZipCode_new
      Sex: Sex_new

- split:
    column: City
    separator: " "

- replace:
    column: Phone_new
    match_value: "555"
    replacement: "XXX"

- replace_characters:
    column: ZipCode_new
    num_characters: 1
    replacement: "^^"
    first: true

- replace_characters:
    column: ZipCode_new
    num_characters: 2
    replacement: "*"
    first: false

- merge:
    columns: [Address, City]
    separator: ", "
    output_column: "Address and City"

- filter_records:
    condition: "Age >= 30"

- map_value:
    column: City_new
    mapping:
      New York: ny
      Los Angeles: la
      Chicago: chi

- map_value:
    column: Sex_new
    mapping:
      M: Male
      F: Female
      U: Unknown

- split_pair:
    column: Name
    separator: " "
    first: false

- convert_case:
    mapping:
      Email_new: uppercase
      City_new: titlecase

# - convert_case:
#     columns:
#       - Email_new
#     case_type: uppercase

- rename_column:
    mapping:
      Name_2: Last_Name
      Name_1: First_Name

# - copy_column:
#     column: Last_Name
#     new_column: Last_Name_new

- sort:
    mapping:
      Age: false
      First_Name: false

# - sort:
#     columns:
#       - Age
#       - First_Name
#     sort_ascending:
#       - false
#       - false

- rename_column:
    mapping:
      Email_new: Email_new Address
# - filter_columns
#   columns:
#     - Name
#     - Email Address
#     - City
